{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://oisp.dev/schema/v0.1/common/host.schema.json",
  "title": "OISP Host Context",
  "description": "Information about the host/device where an event originated",
  "type": "object",
  "properties": {
    "hostname": {
      "type": "string",
      "description": "Hostname of the machine",
      "examples": ["dev-laptop", "prod-server-01"]
    },
    "device_id": {
      "type": "string",
      "description": "Unique device identifier (MDM-assigned, hardware ID, or generated)",
      "examples": ["550e8400-e29b-41d4-a716-446655440000"]
    },
    "os": {
      "type": "string",
      "description": "Operating system family",
      "enum": ["linux", "darwin", "windows", "freebsd", "other"],
      "examples": ["linux", "darwin"]
    },
    "os_version": {
      "type": "string",
      "description": "Operating system version",
      "examples": ["Ubuntu 22.04", "macOS 14.2", "Windows 11 23H2"]
    },
    "arch": {
      "type": "string",
      "description": "CPU architecture",
      "enum": ["x86_64", "aarch64", "arm", "i686", "other"],
      "examples": ["x86_64", "aarch64"]
    },
    "kernel_version": {
      "type": "string",
      "description": "Kernel or NT version",
      "examples": ["6.5.0-44-generic", "23.2.0"]
    },
    "cloud": {
      "type": "object",
      "description": "Cloud provider metadata if running in cloud",
      "properties": {
        "provider": {
          "type": "string",
          "enum": ["aws", "gcp", "azure", "digitalocean", "other"],
          "description": "Cloud provider"
        },
        "region": {
          "type": "string",
          "description": "Cloud region",
          "examples": ["us-east-1", "europe-west1"]
        },
        "instance_id": {
          "type": "string",
          "description": "Cloud instance ID"
        },
        "instance_type": {
          "type": "string",
          "description": "Instance type/size",
          "examples": ["t3.medium", "n1-standard-4"]
        }
      }
    },
    "container": {
      "type": "object",
      "description": "Container context if running in a container",
      "properties": {
        "id": {
          "type": "string",
          "description": "Container ID"
        },
        "name": {
          "type": "string",
          "description": "Container name"
        },
        "image": {
          "type": "string",
          "description": "Container image name and tag",
          "examples": ["python:3.11-slim", "node:20-alpine"]
        },
        "runtime": {
          "type": "string",
          "enum": ["docker", "containerd", "crio", "podman", "other"],
          "description": "Container runtime"
        }
      }
    },
    "k8s": {
      "type": "object",
      "description": "Kubernetes context if running in K8s",
      "properties": {
        "cluster_name": {
          "type": "string",
          "description": "Kubernetes cluster name"
        },
        "namespace": {
          "type": "string",
          "description": "Kubernetes namespace"
        },
        "pod_name": {
          "type": "string",
          "description": "Pod name"
        },
        "pod_uid": {
          "type": "string",
          "description": "Pod UID"
        },
        "node_name": {
          "type": "string",
          "description": "Node name"
        },
        "deployment": {
          "type": "string",
          "description": "Deployment name if applicable"
        },
        "service_account": {
          "type": "string",
          "description": "Service account name"
        },
        "labels": {
          "type": "object",
          "description": "Pod labels",
          "additionalProperties": {
            "type": "string"
          }
        }
      }
    },
    "managed": {
      "type": "boolean",
      "description": "Whether this is a managed/corporate device (from MDM or policy)"
    },
    "tags": {
      "type": "array",
      "description": "Custom tags for this host",
      "items": {
        "type": "string"
      },
      "examples": [["production", "web-tier"]]
    }
  },
  "additionalProperties": true
}

